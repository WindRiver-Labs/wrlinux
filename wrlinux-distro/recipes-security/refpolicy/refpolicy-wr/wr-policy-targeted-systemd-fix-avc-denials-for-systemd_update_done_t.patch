From f1d7f00c5710e2754b20f3882bad5dd604683f2a Mon Sep 17 00:00:00 2001
From: Yi Zhao <yi.zhao@windriver.com>
Date: Thu, 23 May 2019 15:01:26 +0800
Subject: [PATCH] systemd: fix avc denials for systemd_update_done_t

Remove unnecessary names in systemd-update-done filetrans.

Upstream-Status: Pending

Signed-off-by: Yi Zhao <yi.zhao@windriver.com>
---
 policy/modules/system/systemd.te | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/policy/modules/system/systemd.te b/policy/modules/system/systemd.te
index b6c13d0..0bce04a 100644
--- a/policy/modules/system/systemd.te
+++ b/policy/modules/system/systemd.te
@@ -1208,11 +1208,13 @@ allow systemd_update_done_t self:process setfscreate;
 
 allow systemd_update_done_t systemd_update_run_t:file manage_file_perms;
 
-files_etc_filetrans(systemd_update_done_t, systemd_update_run_t, file, ".updated")
-files_var_filetrans(systemd_update_done_t, systemd_update_run_t, file, ".updated")
+files_etc_filetrans(systemd_update_done_t, systemd_update_run_t, file)
+files_var_filetrans(systemd_update_done_t, systemd_update_run_t, file)
 
 seutil_read_file_contexts(systemd_update_done_t)
 
 systemd_service_allow_kernel_domain_access_to_sysctl_kernel_t(systemd_tmpfiles_t)
 systemd_service_allow_kernel_files_domain_to_tmp_t(systemd_tmpfiles_t)
 systemd_log_parse_environment(systemd_update_done_t)
+
+kernel_read_kernel_sysctls(systemd_update_done_t)
-- 
2.7.4

