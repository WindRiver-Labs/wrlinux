#
# Copyright (C) 2012-2014, 2019 Wind River Systems, Inc.
#

RDEPENDS_${PN} += "policycoreutils"

FILESEXTRAPATHS_prepend := "${THISDIR}/refpolicy-wr:"

# Fix file contexts
SRC_URI += "file://wr-fc-subs_dist-busybox.patch \
            file://wr-fc-subs_dist-systemd.patch \
            file://wr-fc-authlogin.patch \
            file://wr-fc-brctl.patch \
            file://wr-fc-corecommands.patch \
            file://wr-fc-fstools.patch \
            file://wr-fc-kerberos.patch \
            file://wr-fc-ldap.patch \
            file://wr-fc-locallogin.patch \
            file://wr-fc-ntp.patch \
            file://wr-fc-postgresql.patch \
            file://wr-fc-rpm.patch \
            file://wr-fc-screen.patch \
            file://wr-fc-usermanage.patch \
            file://wr-fc-udev-udevadm.patch \
           "

# Other policy fixes
SRC_URI += "file://wr-policy-fix-dev-log-label.patch \
            file://wr-policy-getty-console.patch \
            file://wr-policy-syslog-ng.patch \
            file://wr-policy-syslog-ng-allow-read-rand-urand-device.patch \
            file://wr-policy-kdump-bool-sysadm.patch \
            file://wr-policy-MLS-sysadm-rw-to-clearance.patch \
            file://wr-policy-virt-bool-unconfined-vm.patch \
            file://wr-policy-mount-allow-setsched-for-kernel_t-process.patch \
            file://wr-policy-mount-allow-override-context.patch \
            file://wr-policy-dmesg-allow-dmesg-read-dev-kmsg.patch \
            file://wr-policy-zebra-allow-zebra_t-manage-zebra_tmp_t-files.patch \
            file://wr-policy-postfix-allow-postfix-script-read-var.patch \
            file://wr-policy-ldap-allow-slapd-read-dev-random.patch \
            file://wr-policy-alsa-allow-alsactl-search-dev-snd.patch \
            file://wr-policy-remove-avc-denied-for-named-service.patch \
            file://wr-policy-samhain-fix-avc-denied.patch \
            file://wr-policy-samba-fix-avc-denied.patch \
            file://wr-policy-bind-dontaudit-mount-write-setattr.patch \
            file://wr-policy-selinuxutil-allow-run_init-exec-all-initscripts.patch \
            file://wr-policy-sysadm-allow-to-exec-kadmind.patch \
            file://wr-policy-dhcp-dontaudit-rw-to-dev-console-pts.patch \
            file://wr-policy-logging-allow-auditctl-read-tmp-lnk_file.patch \
            file://wr-policy-dontaudit-attempts-to-search-kernel-debugfs.patch \
            file://wr-policy-allow-ifconfig-to-read-search-var-run.patch \
            file://wr-policy-portmap-allow-portmap-to-create-socket.patch \
            file://wr-policy-drbd.patch \
            file://wr-policy-allow-sysadm-run-crontab.patch \
            file://wr-policy-kerberos.patch \
            file://wr-policy-selinuxutils.patch \
            file://wr-policy-modutils.patch \
            file://wr-policy-give-ppp_on_boot-script-correct-file-context.patch \
            file://wr-policy-allow-setrans-to-access-sys-fs-selinux.patch \
            file://wr-policy-make-openais-be-able-to-work.patch \
            file://wr-policy-give-resolv.conf-the-net_conf_t-security-label.patch \
            file://wr-policy-clock-allow-hwclock_t-create-adjtime_t.patch \
            file://wr-policy-mls-newgrp.patch \
            file://wr-policy-avahi-dontaudit-rw-console.patch \
            file://wr-policy-telnet-fix-for-telnetlogin.patch \
            file://wr-policy-fix-security_validate_transition.patch \
            file://wr-policy-init_t-get-all-service-status.patch \
            file://wr-policy-allow-init_t-read-any-level-sockets.patch \
            file://wr-policy-fix-avc-denials-from-systemd-logind.patch \
            file://wr-policy-fix-systemd-journal-failure.patch \
            file://wr-policy-fix-avc-denials-from-systemd-cgroups.patch \
            file://wr-policy-fix-avc-denials-from-systemd-tmpfile.patch \
            file://wr-policy-fix-avc-denials-from-watchdog.patch \
            file://wr-policy-allow-auditd-use-all-levels-fd.patch \
            file://wr-policy-allow-sysadm_t-start-stop-status-service.patch \
            file://wr-policy-fix-service-radiusd.patch \
            file://wr-policy-fix-avc-denials-about-searching-journal-dir.patch \
            file://wr-policy-allow-daemon-write-to-socket-file.patch \
            file://wr-policy-allow-ftpd_t-auditd_t-write-to-socket-at-a.patch \
            file://wr-policy-allow-systemd_logind_t-manage-run-user.patch \
            file://wr-policy-fix-avc-denials-for-ipsec.patch \
            file://wr-policy-fix-avc-denials-while-running-newaliases.patch \
            file://wr-policy-fix-avc-denials-to-setrans_t.patch \
            file://wr-policy-allow-mount_t-getattr-of-all-filesystems.patch \
            file://wr-policy-fix-avc-denials-to-systemd_logind_t.patch \
            file://wr-policy-allow-passwd_t-useradd_t-search-journal.patch \
            file://wr-policy-fix-avc-denial-while-sysvinit-rebooting.patch \
            file://wr-policy-allow-unconfined_domain_type-manage-system.patch \
            file://wr-policy-allow-radiusd_t-getcap-to-itself.patch \
            file://wr-policy-allow-initrc_t-start-systemd_unit_t-servic.patch \
            file://wr-policy-fix-su-failure-with-non-root-users.patch \
            file://wr-policy-dontaudit-several-operations-of-useradd-newrole-and-.patch \
            file://wr-policy-mysql-allow-mysqld_safe-to-read-var-log.patch \
            file://wr-policy-rpcbind-manage-tmpfiles.patch \
            file://wr-policy-fixes-for-type-_sudo_t.patch \
            file://wr-policy-allow-login_pgm-manage-user-keys.patch \
            file://wr-policy-allow-setrans_t-dac_read_search.patch \
            file://wr-policy-fix-label-for-dnssec-keys-file.patch \
            file://wr-policy-fix-avc-denials-for-unix_chkpwd-systemd.patch \
            file://wr-policy-make-init_t-fd-useable-by-all-levels.patch \
            file://wr-policy-create-faillogs-with-type-faillog_t.patch \
            file://wr-policy-fix-avc_context_to_sid_raw-assertion-avc_r.patch \
            file://wr-policy-fix-mailx-send-mail-failure.patch \
            file://wr-policy-fix-avc-denials-for-rngd.patch \
            file://wr-policy-fix-avc-denials-for-tcsd.patch \
            file://wr-policy-fix-systemd-logind-fails-to-start.patch \
            file://wr-policy-fix-auditd-fails-to-start.patch \
            file://wr-policy-some-fixes-for-avc-denials.patch \
            file://wr-policy-fix-avc-denials-for-dhcpc_t.patch \
            file://wr-policy-fix-labels-for-run-resolv.conf.patch \
            file://wr-policy-fix-avc-denials.patch \
            file://wr-policy-allow-local_login_t-search-default_t-dir.patch \
            file://wr-policy-allow-useradd_t-to-write-file-at-all-level.patch \
            file://wr-policy-allow-syslogd_t-search-cgroup_t-dirs.patch \
            file://wr-policy-fixes-for-samba-service.patch \
            file://wr-policy-allow-staff_t-read-etc_t-files.patch \
            file://wr-policy-allow-systemd_logind_t-relabel-user_tmp_t-.patch \
            file://wr-policy-add-userdom_transition_login_userdomain-interface.patch \
            file://wr-policy-allow-ping_t-read-all-levels-file.patch \
            file://wr-policy-allow-search-all-pid-dirs-when-managing-net_conf_t-f.patch \
            file://wr-policy-allow-secadm_t-read_policy.patch \
            file://wr-policy-fix-systemd-resolved-failures.patch \
            file://wr-policy-fix-error-for-spawning-lib-systemd-systemd.patch \
            file://wr-policy-allow-systemd_backlight_t-read-all-level-f.patch \
            file://wr-policy-allow-nmbd_t-read-all-level-files.patch \
            file://wr-policy-fix-labels-for-resolv.conf.patch \
            file://wr-policy-fix-dev_read_framebuffer.patch \
            file://wr-policy-add-crash-module.patch \
            file://wr-policy-kernel_t-mls-trusted-for-lowering-file-l.patch \
            file://wr-policy-rpc-add-capability-dac_read_search-for-rpcd_t.patch \
            file://wr-policy-rpc-allow-rpcd_t-to-read-to-clearance.patch \
            file://wr-policy-ntp-fix-avc-denials-for-ntpd_t.patch \
            file://wr-policy-systemd-fix-avc-denials-for-systemd_networkd_t.patch \
            file://wr-policy-systemd-fix-avc-denials-for-systemd_resolved_t.patch \
            file://wr-policy-systemd-fix-avc-denials-for-systemd_update_done_t.patch \
            file://wr-policy-systemd-fix-avc-denials-for-systemd_modules_load_t.patch \
            file://wr-policy-systemd-fix-avc-denials-for-systemd_gpt_generator_t.patch \
            file://wr-policy-systemd-fix-avc-denials-for-systemd_hw_t.patch \
            file://wr-policy-systemd-fix-avc-denials-for-systemd_sessions_t.patch \
            file://wr-policy-systemd-allow-systemd_-domain-to-map-generic-files-i.patch \
            file://wr-policy-getty-fix-avc-denials-for-getty_t.patch \
            file://wr-policy-radius-fix-avc-denials-for-radiusd_t.patch \
            file://wr-policy-cron-fix-avc-denials-for-crond_t.patch \
            file://wr-policy-allow-the-specified-domain-to-map-generic-fil.patch \
            file://wr-policy-fix-avc-denials-for-net_conf_t.patch \
            file://wr-policy-dbus-fix-avc-denials-for-system_dbusd_var_run_t.patch \
            file://wr-policy-sysadm-fix-avc-denials-for-sysadm_t.patch \
            file://wr-policy-sysadm-allow-sysadm_t-to-read-write-dev-kmsg.patch \
            file://wr-policy-sysnetwork-fix-avc-denials-for-ifconfig_t.patch \
            file://wr-policy-udev-fix-avc-denials-for-udevadm_t.patch \
            file://wr-policy-logwatch-fix-avc-denials-for-logwatch_t.patch \
            file://wr-policy-init-fix-avc-denials-for-init_t.patch \
            file://wr-policy-ipsec-fix-avc-denials-for-ipsec_t.patch \
            file://wr-policy-snmp-fix-avc-denials-for-snmpd_t.patch \
            file://wr-policy-samba-fix-avc-denials-for-smbd_t-and-nmbd_t.patch \
            file://wr-policy-samba-enable-samba_export_all_rw-and-samba_export_al.patch \
            file://wr-policy-rpm-fix-avc-denials-for-rpm_t.patch \
            file://wr-policy-postfix-fix-avc-denials-for-postfix_local_t.patch \
            file://wr-policy-revert-remove-unused-translate-permission-in-context.patch \
           "
