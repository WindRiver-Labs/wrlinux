From 56d8aa0550d8ae445ead1b8533dd5148319ee307 Mon Sep 17 00:00:00 2001
From: Wenzong Fan <wenzong.fan@windriver.com>
Date: Thu, 20 Feb 2014 04:33:48 -0500
Subject: [PATCH] allow postfix-script read /var

Fix avc denied issue:

type=AVC msg=audit(1392887181.509:58): avc:  denied  \
{ read } for  pid=594 comm="postfix-script" name="var" dev="hda" \
ino=27745 scontext=system_u:system_r:postfix_master_t:s0-s15:c0.c1023 \
tcontext=system_u:object_r:var_t:s0 tclass=dir

Upstream-Status: Pending

Signed-off-by: Wenzong Fan <wenzong.fan@windriver.com>
---
 policy/modules/services/postfix.te | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/policy/modules/services/postfix.te b/policy/modules/services/postfix.te
index aec7af1..bd066c3 100644
--- a/policy/modules/services/postfix.te
+++ b/policy/modules/services/postfix.te
@@ -223,6 +223,8 @@ allow postfix_master_t { postfix_postdrop_exec_t postfix_postqueue_exec_t }:file
 
 allow postfix_master_t postfix_prng_t:file rw_file_perms;
 
+allow postfix_master_t var_t:dir read;
+
 manage_dirs_pattern(postfix_master_t, postfix_spool_t, postfix_spool_t)
 manage_files_pattern(postfix_master_t, postfix_spool_t, postfix_spool_t)
 files_spool_filetrans(postfix_master_t, postfix_spool_t, dir)
@@ -299,6 +301,7 @@ corecmd_exec_bin(postfix_master_t)
 
 domain_use_interactive_fds(postfix_master_t)
 
+files_map_etc_files(postfix_master_t)
 files_search_tmp(postfix_master_t)
 
 mcs_file_read_all(postfix_master_t)
-- 
2.7.4

