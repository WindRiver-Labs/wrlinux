From 110f916ac6764f8160ec4a6be9d03eb57dd10a75 Mon Sep 17 00:00:00 2001
From: Wenzong Fan <wenzong.fan@windriver.com>
Date: Thu, 28 Dec 2017 08:14:05 +0000
Subject: [PATCH] wr-policy: allow staff_t read etc_t files

Fix avc denial:
  avc: denied { read } for pid=469 comm="uname" \
  name="ld.so.cache" dev="sda1" ino=1063343 \
  scontext=root:staff_r:staff_t:s0-s15:c0.c1023 \
  tcontext=system_u:object_r:etc_t:s15:c0.c1023 tclass=file

Upstream-Status: Pending

Signed-off-by: Wenzong Fan <wenzong.fan@windriver.com>
---
 policy/modules/roles/staff.te | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/policy/modules/roles/staff.te b/policy/modules/roles/staff.te
index 778ef8e..b737398 100644
--- a/policy/modules/roles/staff.te
+++ b/policy/modules/roles/staff.te
@@ -72,6 +72,8 @@ optional_policy(`
 	xserver_role(staff_r, staff_t)
 ')
 
+mls_file_read_all_levels(staff_t)
+
 ifndef(`distro_redhat',`
 	optional_policy(`
 		auth_role(staff_r, staff_t)
-- 
2.7.4

