From a3c42bbfce89f99b75129f2d09ba6f947defbf6f Mon Sep 17 00:00:00 2001
From: Wenzong Fan <wenzong.fan@windriver.com>
Date: Fri, 2 Feb 2018 07:16:07 +0000
Subject: [PATCH] wr-policy: allow nmbd_t read all level files

Remove avc denial:
  avc: denied { search } for pid=517 comm="nmbd" \
  name="journal" dev="tmpfs" ino=697 \
  scontext=system_u:system_r:nmbd_t:s0-s15:c0.c1023 \
  tcontext=system_u:object_r:syslogd_var_run_t:s15:c0.c1023 tclass=dir

Upstream-Status: Pending

Signed-off-by: Wenzong Fan <wenzong.fan@windriver.com>
---
 policy/modules/services/samba.te | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/policy/modules/services/samba.te b/policy/modules/services/samba.te
index 1afe886..c989e90 100644
--- a/policy/modules/services/samba.te
+++ b/policy/modules/services/samba.te
@@ -605,6 +605,8 @@ miscfiles_read_localization(nmbd_t)
 userdom_use_unpriv_users_fds(nmbd_t)
 userdom_user_home_dir_filetrans_user_home_content(nmbd_t, { file dir })
 
+mls_file_read_all_levels(nmbd_t)
+
 tunable_policy(`samba_export_all_ro',`
 	fs_read_noxattr_fs_files(nmbd_t)
 	files_list_non_auth_dirs(nmbd_t)
-- 
2.7.4

