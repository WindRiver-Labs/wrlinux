From abd70040e8549bff6a708d60a1e02658a148cf6e Mon Sep 17 00:00:00 2001
From: De Huo <De.Huo@windriver.com>
Date: Wed, 14 Aug 2019 18:48:34 +0800
Subject: [PATCH] Rule kernel_module_dccp_disabled add oval check

For rule kernel_module_dccp_disabled add oval check

Upstream-Status: Pending

Signed-off-by: De Huo <De.Huo@windriver.com>
---
 .../oval/wrlinux1019.xml                           | 86 ++++++++++++++++++++++
 1 file changed, 86 insertions(+)
 create mode 100644 linux_os/guide/system/network/network-uncommon/kernel_module_dccp_disabled/oval/wrlinux1019.xml

diff --git a/linux_os/guide/system/network/network-uncommon/kernel_module_dccp_disabled/oval/wrlinux1019.xml b/linux_os/guide/system/network/network-uncommon/kernel_module_dccp_disabled/oval/wrlinux1019.xml
new file mode 100644
index 0000000..c1291af
--- /dev/null
+++ b/linux_os/guide/system/network/network-uncommon/kernel_module_dccp_disabled/oval/wrlinux1019.xml
@@ -0,0 +1,86 @@
+<def-group>
+ <!-- THIS FILE IS GENERATED by create_kernel_modules_disabled.py.  DO NOT EDIT.  -->
+  <definition class="compliance"
+  id="kernel_module_dccp_disabled" version="1">
+    <metadata>
+      <title>Disable dccp Kernel Module</title>
+      <affected family="unix">
+        <platform>multi_platform_wrlinux</platform>
+      </affected>
+      <description>The kernel module dccp should be disabled.</description>
+      <reference source="galford" ref_id="20150819" ref_url="test_attestation"/>
+    </metadata>
+    <criteria operator="OR">
+      <criterion test_ref="test_kernmod_dccp_disabled" comment="kernel module dccp disabled in /etc/modprobe.d" />
+      <criterion test_ref="test_kernmod_dccp_modprobeconf" comment="kernel module dccp disabled in /etc/modprobe.conf" />
+      <criterion test_ref="test_kernmod_dccp_etcmodules-load" comment="kernel module dccp disabled in /etc/modules-load.d" />
+      <criterion test_ref="test_kernmod_dccp_runmodules-load" comment="kernel module dccp disabled in /run/modules-load.d" />
+      <criterion test_ref="test_kernmod_dccp_libmodules-load" comment="kernel module dccp disabled in /usr/lib/modules-load.d" />
+    </criteria>
+  </definition>
+
+  <ind:textfilecontent54_test id="test_kernmod_dccp_disabled" version="1" check="all"
+  comment="kernel module dccp disabled">
+    <ind:object object_ref="obj_kernmod_dccp_disabled" />
+  </ind:textfilecontent54_test>
+
+  <ind:textfilecontent54_test id="test_kernmod_dccp_modprobeconf" version="1" check="all"
+  comment="kernel module dccp disabled in /etc/modprobe.conf">
+    <ind:object object_ref="obj_kernmod_dccp_modprobeconf" />
+  </ind:textfilecontent54_test>
+
+  <ind:textfilecontent54_test id="test_kernmod_dccp_etcmodules-load" version="1" check="all"
+  comment="kernel module dccp disabled in /etc/modules-load.d">
+    <ind:object object_ref="obj_kernmod_dccp_etcmodules-load" />
+  </ind:textfilecontent54_test>
+
+  <ind:textfilecontent54_test id="test_kernmod_dccp_runmodules-load" version="1" check="all"
+  comment="kernel module dccp disabled in /run/modules-load.d">
+    <ind:object object_ref="obj_kernmod_dccp_runmodules-load" />
+  </ind:textfilecontent54_test>
+
+  <ind:textfilecontent54_test id="test_kernmod_dccp_libmodules-load" version="1" check="all"
+  comment="kernel module dccp disabled in /usr/lib/modules-load.d">
+    <ind:object object_ref="obj_kernmod_dccp_libmodules-load" />
+  </ind:textfilecontent54_test>
+
+  <ind:textfilecontent54_object id="obj_kernmod_dccp_disabled"
+  version="1" comment="kernel module dccp disabled">
+    <ind:path>/etc/modprobe.d</ind:path>
+    <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
+    <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
+    <ind:instance datatype="int">1</ind:instance>
+  </ind:textfilecontent54_object>
+
+  <ind:textfilecontent54_object id="obj_kernmod_dccp_modprobeconf"
+  version="1" comment="Check deprecated /etc/modprobe.conf for disablement of dccp">
+    <ind:filepath>/etc/modprobe.conf</ind:filepath>
+    <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
+    <ind:instance datatype="int">1</ind:instance>
+  </ind:textfilecontent54_object>
+
+  <ind:textfilecontent54_object id="obj_kernmod_dccp_etcmodules-load"
+  version="1" comment="kernel module dccp disabled in /etc/modules-load.d">
+    <ind:path>/etc/modules-load.d</ind:path>
+    <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
+    <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
+    <ind:instance datatype="int">1</ind:instance>
+  </ind:textfilecontent54_object>
+
+  <ind:textfilecontent54_object id="obj_kernmod_dccp_runmodules-load"
+  version="1" comment="kernel module dccp disabled in /run/modules-load.d">
+    <ind:path>/run/modules-load.d</ind:path>
+    <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
+    <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
+    <ind:instance datatype="int">1</ind:instance>
+  </ind:textfilecontent54_object>
+
+  <ind:textfilecontent54_object id="obj_kernmod_dccp_libmodules-load"
+  version="1" comment="kernel module dccp disabled in /usr/lib/modules-load.d">
+    <ind:path>/usr/lib/modules-load.d</ind:path>
+    <ind:filename operation="pattern match">^.*\.conf$</ind:filename>
+    <ind:pattern operation="pattern match">^\s*install\s+dccp\s+(/bin/false|/bin/true)$</ind:pattern>
+    <ind:instance datatype="int">1</ind:instance>
+  </ind:textfilecontent54_object>
+
+</def-group>
-- 
1.9.1

